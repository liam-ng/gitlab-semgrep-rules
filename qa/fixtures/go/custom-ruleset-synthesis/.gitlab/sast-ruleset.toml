[semgrep]
  description = 'semgrep custom rules configuration'
  targetdir = "/sgrules"
  validate = true

  [[semgrep.passthrough]]
    type  = "raw"
    value = """# My ruleset
"""
    target = "rule.yml"

  [[semgrep.passthrough]]
    type  = "url"
    value = "https://gitlab.com/gitlab-org/security-products/analyzers/semgrep/-/raw/bump_semgrep_version_1_23_0/testdata/url-passthrough/gitlab.yml"
    target = "rule.yml"
    mode = "append"

  [[semgrep.passthrough]]
    type  = "file"
    value = "foo.yml"
    target = "rule.yml"
    mode = "append"

  [[semgrep.passthrough]]
    type  = "raw"
    mode  = "append"
    target = "rule.yml"
    value = """
- id: "baz"
  patterns:
  - pattern: "func baz() {...}"
  message: |
    Function baz detected
  metadata:
    shortDescription: "Exposure of Sensitive Information to an Unauthorized Actor"
    cwe: "CWE-200"
  severity: "ERROR"
  languages:
  - "go"
"""

  [[semgrep.passthrough]]
    type  = "file"
    value = "bar.yml"
    validator = "yaml"

  [[semgrep.passthrough]]
    type  = "git"
    value = "https://github.com/dgryski/semgrep-go"
    ref = "4c51248dac62f96894a997f8e685409516d4a32e"